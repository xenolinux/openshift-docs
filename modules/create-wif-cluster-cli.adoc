// Module included in the following assemblies:
//
// * osd_gcp_clusters/osd-creating-a-cluster-on-gcp-with-workload-identity-federation.adoc
// * osd_getting_started/osd-getting-started.adoc


:_mod-docs-content-type: PROCEDURE
[id="create-wif-cluster-cli_{context}"]
= Creating a Workload Identity Federation cluster using the OCM CLI

[role="_abstract"]
You can create an {product-title} on {GCP} cluster with Workload Identity Federation (WIF) using the OpenShift Cluster Manager CLI (`ocm`) in interactive or non-interactive mode.

.Prerequisites

* You have created a WIF configuration. For more information, see "Creating a Workload Identity Federation configuration".
* You have downloaded the latest version of the {cluster-manager} CLI (`ocm`) for your operating system from the link:https://console.redhat.com/openshift/downloads[Downloads] page on {cluster-manager}.

.Procedure
You can create a WIF cluster using the `interactive` mode or the `non-interactive` mode.

In `interactive` mode, cluster attributes are displayed automatically as prompts during the creation of the cluster. You enter the values for those prompts based on specified requirements in the fields provided.

In `non-interactive` mode, you specify the values for specific parameters within the command.

* Based on your mode preference, run one of the following commands to create an {product-title} cluster on {gcp-short} with WIF configuration:

** Create a cluster in interactive mode by running the following command:
+
[source,terminal]
----
$ ocm create cluster --interactive
----
+
where:

`--interactive`:: Specifies that the cluster is created in interactive mode. This mode prompts you to enter the required configuration options during cluster creation. If you do not include this parameter, the cluster is created in `non-interactive` mode by default.
+
** Create a cluster in non-interactive mode by running the following command:
+
[NOTE]
====
The following example is made up optional and required parameters and may differ from your `non-interactive` mode command. Parameters not identified as optional are required. For additional details about these and other parameters, run the `ocm create cluster --help flag` command in you terminal window.
====
+
[source,terminal]
----
$ ocm create cluster <cluster_name> \
--provider=gcp \
--ccs=true \
--wif-config <wif_name> \
--region <gcp_region> \
--subscription-type=marketplace-gcp \
--marketplace-gcp-terms=true \
--version <version> \
--multi-az=true  \
--enable-autoscaling=true \
--min-replicas=3 \
--max-replicas=6 \
--secure-boot-for-shielded-vms=true
--channel-group <channel_group_name>
----
+
where:

`<cluster_name>`:: Specifies the name of the cluster. Replace `<cluster_name>` with a name for your cluster.

`--provider=gcp`:: Specifies the cloud provider for the cluster.

`--ccs=true`:: Specifies that the cluster is a Customer Cloud Subscription (CCS) cluster.

`--wif-config <wif_name>`:: Specifies the name of the WIF configuration to assign to the cluster. Replace `<wif_name>` with the name of your WIF configuration.

`--region <gcp_region>`:: Specifies the {GCP} region where the new cluster will be deployed. Replace `<gcp_region>` with the desired {GCP} region.

`--subscription-type=marketplace-gcp`:: Specifies the subscription billing model for the cluster. This parameter is optional.

`--marketplace-gcp-terms=true`:: Confirms that you have accepted the {GCP} Marketplace terms and agreements for the OpenShift Dedicated product listing. This parameter is required if you provided a value of `marketplace-gcp` for the `subscription-type` parameter.

`--version <version>`:: Specifies the desired {product-title} version. This parameter is optional. However, if an {product-title} version is specified, the version must also be supported by the assigned WIF configuration. If a version is specified that is not supported by the assigned WIF configuration, cluster creation will fail.
If this occurs, update the assigned WIF configuration to the desired version or create a new WIF configuration with the desired version. If you do not specify a version, the cluster is created with the default version for the assigned WIF configuration.
+
For more information about supported versions for WIF configurations, see "Creating a Workload Identity Federation configuration".

`--multi-az=true`:: Specifies that the cluster is deployed to multiple data centers. This parameter is optional.

`--enable-autoscaling=true`:: Enables autoscaling of compute nodes. This parameter is optional.

`--min-replicas=3`:: Specifies the minimum number of compute nodes. This parameter is optional.

`--max-replicas=6`:: Specifies the maximum number of compute nodes. This parameter is optional.

`--secure-boot-for-shielded-vms=true`:: Enables Secure Boot, which allows the use of Shielded VMs in the {gcp-full}. This parameter is optional.

`--channel-group <channel_group_name>`:: Specifies the name of the channel group you want to assign the cluster to. Channel group options include `stable` and `eus`. Replace `<channel_group_name>` with the desired channel group. This parameter is optional.

[IMPORTANT]
====
If your cluster deployment fails during installation, certain resources created during the installation process are not automatically removed from your {GCP} account. To remove these resources from your {gcp-short} account, you must delete the failed cluster. For more information, see "Deleting an {product-title} cluster on {GCP}".
====

.Verification

* To verify that the cluster was created successfully, run the following command:
+
[source,terminal]
----
$ ocm get cluster <cluster_name>
----
+
If the cluster was created successfully, the output displays the cluster state as `ready`.